<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Pendaftar Proyek</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.13.8/css/dataTables.bootstrap5.min.css"
        rel="stylesheet">

    <style>
        body {
            margin: 0;
        }

        .section-title {
            font-weight: 700;
            color: #1f3b63;
            font-size: 16px;
        }

        .aksi-btn {
            width: 36px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            background: #fff;
        }

        .aksi-btn i {
            font-size: 22px;
        }

        .btn-terima {
            border: 1px solid #27ae60;
            color: #27ae60;
        }

        .btn-tolak {
            border: 1px solid #e74c3c;
            color: #e74c3c;
        }

        /* Modal */
        .modal-box {
            border-radius: 12px;
            text-align: center;
            padding: 25px;
        }

        .modal-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px auto;
            font-size: 32px;
        }

        .btn-tidak {
            border: 1px solid #aaa;
            background: #fff;
            color: #555;
            border-radius: 6px;
            padding: 6px 22px;
        }

        .btn-utama {
            background: #cdcec9;
            border: none;
            color: #333;
            border-radius: 6px;
            padding: 6px 22px;
        }

        .btn-utama:hover {
            background: #bfb9b4;
            color: #333;
        }
    </style>
</head>

<body>

    <div id="layout-admin"></div>

    <div id="isi-halaman" style="display:none">

        <div class="mb-3">
            <div class="section-title">Daftar Pendaftar Petugas</div>
        </div>

        <table id="tabel-pendaftar" class="table table-striped align-middle w-100">
            <thead>
                <tr>
                    <th>Nama</th>
                    <th>No HP</th>
                    <th>Kepegawaian</th>
                    <th>Peran</th>
                    <th>Honor</th>
                    <th>Skor Nilai</th>
                    <th>Skor GA</th>
                    <th>Aksi</th>

                </tr>
            </thead>
            <tbody id="tbodyPendaftar"></tbody>
        </table>

    </div>


    <!-- Modal Konfirmasi -->
    <div class="modal fade" id="modalKonfirmasi" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-box">
                <div class="modal-icon" id="iconKonfirmasi"></div>
                <h5 id="teksKonfirmasi"></h5>

                <div class="mt-4 d-flex justify-content-center gap-3">
                    <button class="btn-tidak" data-bs-dismiss="modal">Batal</button>
                    <button class="btn-utama" data-bs-dismiss="modal">Ya</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net@1.13.8/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.13.8/js/dataTables.bootstrap5.min.js"></script>

    <script>
        const dataPendaftar = [
            { event_id: 1, nama: "Rudi Hartono", hp: "0811112222", kepeg: "Senior", peran: "Operator", honor: 150000, nilai: 378, GA: 98.5 },
            { event_id: 1, nama: "Dewi Lestari", hp: "0822223333", kepeg: "Junior", peran: "Asisten", honor: 100000, nilai: 345, GA: 95.6 },
            { event_id: 2, nama: "Agus Pratama", hp: "0833334444", kepeg: "Senior", peran: "Printer (Magnet)", honor: 175000, nilai: 365, GA: 93.4 }
        ];

        function getParamId() {
            const urlParams = new URLSearchParams(window.location.search);
            return parseInt(urlParams.get("id")) || 1;
        }

        function renderTable() {
            const id = getParamId();
            const tbody = document.getElementById("tbodyPendaftar");
            tbody.innerHTML = "";

            dataPendaftar.filter(p => p.event_id === id).forEach(p => {
                tbody.innerHTML += `
        <tr>
            <td>${p.nama}</td>
            <td>${p.hp}</td>
            <td>${p.kepeg}</td>
            <td>${p.peran}</td>
            <td>Rp ${p.honor.toLocaleString("id-ID")}</td>
            <td>${p.nilai}</td>
            <td>${p.GA}</td>
<td>

                <button class="aksi-btn btn-terima btn-konfirmasi" 
                    data-tipe="terima" 
                    data-bs-toggle="modal" 
                    data-bs-target="#modalKonfirmasi">
                    <i class="bi bi-check-lg"></i>
                </button>

                <button class="aksi-btn btn-tolak btn-konfirmasi" 
                    data-tipe="tolak" 
                    data-bs-toggle="modal" 
                    data-bs-target="#modalKonfirmasi">
                    <i class="bi bi-x-lg"></i>
                </button>
            </td>
        </tr>
        `;
            });

            new DataTable('#tabel-pendaftar', { pageLength: 10 });

            document.querySelectorAll(".btn-konfirmasi").forEach(btn => {
                btn.addEventListener("click", function () {
                    const tipe = this.getAttribute("data-tipe");
                    const icon = document.getElementById("iconKonfirmasi");
                    const teks = document.getElementById("teksKonfirmasi");

                    if (tipe === "terima") {
                        icon.style.borderColor = "#27ae60";
                        icon.style.color = "#27ae60";
                        icon.innerHTML = '<i class="bi bi-check-lg"></i>';
                        teks.innerText = "Terima petugas ini ke dalam proyek?";
                    } else {
                        icon.style.borderColor = "#e74c3c";
                        icon.style.color = "#e74c3c";
                        icon.innerHTML = '<i class="bi bi-x-lg"></i>';
                        teks.innerText = "Tolak petugas ini dari proyek?";
                    }
                });
            });
        }

        fetch("../component/sidebar_admin.html")
            .then(r => r.text())
            .then(html => {
                document.getElementById("layout-admin").innerHTML = html;
                document.getElementById("page-title").innerText = "Pendaftar Proyek";
                document.getElementById("konten-halaman").innerHTML = document.getElementById("isi-halaman").innerHTML;

                const sidebar = document.getElementById("sidebar");
                const toggle = document.getElementById("toggleSidebar");
                toggle.addEventListener("click", () => sidebar.classList.toggle("closed"));

                renderTable();
            });
    </script>

</body>

</html>